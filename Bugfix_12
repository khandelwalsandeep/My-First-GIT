Bug fixes for issue-12

Branch 1 changes ; this should be merged into master

Check merge when pulling from master